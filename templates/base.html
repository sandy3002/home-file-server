<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Home File Server{% endblock %}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <style>
      /* Light Theme (default) */
      :root {
        --bg-primary: #ffffff;
        --bg-secondary: #f8f9fa;
        --bg-tertiary: #e9ecef;
        --text-primary: #212529;
        --text-secondary: #6c757d;
        --text-muted: #adb5bd;
        --border-color: #dee2e6;
        --link-color: #0d6efd;
        --link-hover: #0a58ca;
        --success-color: #198754;
        --danger-color: #dc3545;
        --sidebar-bg: #f8f9fa;
        --card-bg: #ffffff;
        --input-bg: #ffffff;
        --input-border: #ced4da;
        --modal-bg: #ffffff;
        --table-hover: #f8f9fa;
        --shadow: rgba(0, 0, 0, 0.1);
      }

      /* Dark Theme */
      [data-theme='dark'] {
        --bg-primary: #212529;
        --bg-secondary: #2c3034;
        --bg-tertiary: #343a40;
        --text-primary: #f8f9fa;
        --text-secondary: #adb5bd;
        --text-muted: #6c757d;
        --border-color: #495057;
        --link-color: #6ea8fe;
        --link-hover: #9ec5fe;
        --success-color: #75b798;
        --danger-color: #ea868f;
        --sidebar-bg: #2c3034;
        --card-bg: #2c3034;
        --input-bg: #343a40;
        --input-border: #495057;
        --modal-bg: #2c3034;
        --table-hover: #343a40;
        --shadow: rgba(0, 0, 0, 0.5);
      }

      body {
        background-color: var(--bg-primary);
        color: var(--text-primary);
        transition: background-color 0.3s ease, color 0.3s ease;
      }

      .sidebar {
        height: 100vh;
        background-color: var(--sidebar-bg);
        border-right: 1px solid var(--border-color);
        transition: background-color 0.3s ease;
      }

      .main-content {
        height: 100vh;
        overflow-y: auto;
        background-color: var(--bg-primary);
        transition: background-color 0.3s ease;
        padding-top: 70px !important;
      }

      .file-icon {
        width: 24px;
        height: 24px;
        margin-right: 8px;
      }

      .media-thumbnail {
        width: 60px;
        height: 60px;
        object-fit: cover;
      }

      .upload-zone {
        border: 2px dashed var(--border-color);
        border-radius: 10px;
        padding: 40px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        background-color: var(--bg-secondary);
      }

      .upload-zone:hover {
        border-color: var(--link-color);
        background-color: var(--bg-tertiary);
      }

      .upload-zone.dragover {
        border-color: var(--success-color);
        background-color: var(--bg-tertiary);
      }

      /* Theme toggle button */
      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-radius: 50px;
        padding: 8px 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px var(--shadow);
      }

      .theme-toggle:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--shadow);
      }

      .theme-toggle i {
        font-size: 1.2rem;
        color: var(--text-primary);
      }

      /* Dark theme specific overrides */
      [data-theme='dark'] .nav-link {
        color: var(--text-secondary);
      }

      [data-theme='dark'] .nav-link:hover {
        color: var(--text-primary);
        background-color: var(--bg-tertiary);
      }

      [data-theme='dark'] .nav-link.active {
        background-color: var(--link-color);
        color: var(--text-primary);
      }

      [data-theme='dark'] .card {
        background-color: var(--card-bg);
        border-color: var(--border-color);
        color: var(--text-primary);
      }

      [data-theme='dark'] .table {
        color: var(--text-primary);
      }

      [data-theme='dark'] .table-hover tbody tr:hover {
        background-color: var(--table-hover);
        color: var(--text-primary);
      }

      [data-theme='dark'] .form-control,
      [data-theme='dark'] .form-select {
        background-color: var(--input-bg);
        border-color: var(--input-border);
        color: var(--text-primary);
      }

      [data-theme='dark'] .form-control:focus,
      [data-theme='dark'] .form-select:focus {
        background-color: var(--input-bg);
        border-color: var(--link-color);
        color: var(--text-primary);
      }

      [data-theme='dark'] .modal-content {
        background-color: var(--modal-bg);
        color: var(--text-primary);
      }

      [data-theme='dark'] .modal-header,
      [data-theme='dark'] .modal-footer {
        border-color: var(--border-color);
      }

      [data-theme='dark'] .btn-close {
        filter: invert(1);
      }

      [data-theme='dark'] .alert {
        background-color: var(--bg-tertiary);
        border-color: var(--border-color);
        color: var(--text-primary);
      }

      [data-theme='dark'] .text-muted {
        color: var(--text-muted) !important;
      }

      [data-theme='dark'] a {
        color: var(--link-color);
      }

      [data-theme='dark'] a:hover {
        color: var(--link-hover);
      }
    </style>
  </head>
  <body>
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle" title="Toggle theme">
      <i class="bi bi-sun-fill" id="themeIcon"></i>
    </button>

    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 col-lg-2 sidebar p-3">
          <h4 class="text-center mb-4">
            <i class="bi bi-hdd-network"></i>
            File Server
          </h4>
          <nav class="nav nav-pills flex-column">
            <a
              class="nav-link {% if request.endpoint == 'index' %}active{% endif %}"
              href="{{ url_for('index') }}"
            >
              <i class="bi bi-house"></i> Dashboard
            </a>
            <a
              class="nav-link {% if request.endpoint == 'browse_files' %}active{% endif %}"
              href="{{ url_for('browse_files') }}"
            >
              <i class="bi bi-folder"></i> Browse Files
            </a>
            <a
              class="nav-link {% if request.endpoint == 'upload_file' %}active{% endif %}"
              href="{{ url_for('upload_file') }}"
            >
              <i class="bi bi-upload"></i> Upload Files
            </a>
          </nav>

          <hr class="my-4" />

          <div class="text-muted small">
            <p><strong>Server Info:</strong></p>
            <p>Host: {{ request.host }}</p>
            <p>Status: <span class="text-success">Online</span></p>
            {% if session.get('username') %}
            <hr class="my-2" />
            <p><strong>Logged in as:</strong></p>
            <p>{{ session.get('username') }}</p>
            <a
              href="{{ url_for('logout') }}"
              class="btn btn-sm btn-outline-danger w-100"
            >
              <i class="bi bi-box-arrow-right"></i> Logout
            </a>
            {% endif %}
          </div>
        </div>

        <!-- Main Content -->
        <div class="col-md-9 col-lg-10 main-content p-4">
          {% with messages = get_flashed_messages() %} {% if messages %} {% for
          message in messages %}
          <div
            class="alert alert-info alert-dismissible fade show"
            role="alert"
          >
            {{ message }}
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
            ></button>
          </div>
          {% endfor %} {% endif %} {% endwith %} {% block content %}{% endblock
          %}
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Theme Toggle Script -->
    <script>
      // Initialize theme from localStorage or default to light
      const initTheme = () => {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);
      };

      // Update theme icon based on current theme
      const updateThemeIcon = (theme) => {
        const themeIcon = document.getElementById('themeIcon');
        if (theme === 'dark') {
          themeIcon.className = 'bi bi-moon-fill';
        } else {
          themeIcon.className = 'bi bi-sun-fill';
        }
      };

      // Toggle theme
      const toggleTheme = () => {
        const currentTheme =
          document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        updateThemeIcon(newTheme);
      };

      // Initialize theme on page load
      initTheme();

      // Add click event listener to theme toggle button
      document
        .getElementById('themeToggle')
        .addEventListener('click', toggleTheme);
    </script>

    {% block scripts %}{% endblock %}
  </body>
</html>
